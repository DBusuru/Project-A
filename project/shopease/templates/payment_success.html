{% extends 'emails/base_email.html' %}

{% block content %}
<div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
    <div style="background-color: #28a745; color: white; padding: 20px; text-align: center;">
        <h2>Payment Successful!</h2>
    </div>
    
    <div style="padding: 20px; background-color: #fff;">
        <p>Hello {{ order.user.first_name }},</p>
        
        <p>Your payment for order #{{ order.id }} has been successfully received.</p>
        
        <div style="background-color: #f8f9fa; padding: 15px; margin: 20px 0;">
            <h3 style="margin-top: 0;">Payment Details:</h3>
            <p>Amount Paid: KES {{ amount|floatformat:2 }}</p>
            <p>M-Pesa Receipt: {{ mpesa_receipt }}</p>
            <p>Date: {{ payment_date|date:"F j, Y H:i" }}</p>
        </div>
        
        {% if order.payment_plan == 'installment' %}
            <div style="background-color: #fff3cd; padding: 15px; margin: 20px 0;">
                <h3 style="margin-top: 0;">Installment Status:</h3>
                <p>Installment {{ current_installment }}/3 completed</p>
                <p>Remaining Balance: KES {{ remaining_balance|floatformat:2 }}</p>
                {% if next_due_date %}
                    <p>Next Payment Due: {{ next_due_date|date:"F j, Y" }}</p>
                {% endif %}
            </div>
        {% endif %}
        
        <div style="margin: 20px 0;">
            <p><strong>Delivery Status:</strong> {{ order.get_delivery_status_display }}</p>
            {% if order.payment_plan == 'full' or all_installments_paid %}
                <p>Your order will be processed and shipped soon.</p>
            {% else %}
                <p>Your order will be processed after all installments are completed.</p>
            {% endif %}
        </div>
        
        <div style="text-align: center; margin: 30px 0;">
            <a href="{{ order_url }}" style="background-color: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">
                View Order Details
            </a>
        </div>
    </div>
    
    <div style="background-color: #f8f9fa; padding: 20px; text-align: center; font-size: 12px;">
        <p>If you have any questions, please contact our support team.</p>
        <p>Thank you for shopping with ShopEase!</p>
    </div>
</div>
{% endblock %}